## [2024-03-12] - Начало работы над интеграцией с Wix API
### Добавлено
- Базовая структура WixApiService для работы с API Wix
- Документация по задачам интеграции с Wix

### Изменено
- Обновлен tasktracker.md с новыми задачами по интеграции

### Планируется
- Реализация методов для работы с товарами (получение по SKU, обновление стока)
- Интеграция с основным потоком данных Allegro -> Wix 

## [2024-03-19] - Реализация работы с инвентарем Wix
### Добавлено
- Модели для работы с инвентарем Wix (WixInventoryVariant, WixPreorderInfo, WixInventoryItem и др.)
- Метод query_inventory для получения информации об инвентаре
- Метод update_inventory для обновления количества товаров
- Документация по работе с инвентарем в project.md

### Изменено
- Обновлена структура WixApiService для поддержки работы с инвентарем
- Улучшена обработка ошибок при работе с API

### Планируется
- Добавление тестов для методов работы с инвентарем
- Реализация массового обновления инвентаря
- Добавление кэширования для оптимизации запросов

## [2024-03-19] - Улучшение работы с API Wix
### Добавлено
- Реализованы высокоуровневые методы для получения всех товаров и инвентарей с учетом ограничений API
- Добавлена поддержка фильтрации для товаров и инвентарей
- Добавлены модели фильтров `WixProductFilter` и `WixInventoryFilter`
- Реализована постраничная загрузка данных с автоматической обработкой лимитов API

### Изменено
- Улучшена валидация данных в моделях инвентаря
- Оптимизирована обработка ошибок при работе с API
- Добавлено подробное логирование для отладки
- Улучшена обработка алиасов полей в моделях

### Исправлено
- Исправлена валидация вариантов товаров в инвентаре
- Исправлена обработка preorder_info в моделях
- Исправлена обработка метаданных в ответах API
- Исправлена работа с алиасами полей в моделях 

## [2024-03-21] - Добавлен метод получения офферов Allegro
### Добавлено
- Новый метод `get_offers` в `SyncAllegroApiService` и `AsyncAllegroApiService` для получения списка офферов с фильтрацией
- Поддержка фильтрации по external.id с валидацией длины
- Поддержка пагинации и сортировки результатов
- Поддержка фильтрации по статусу публикации и маркетплейсу 

## [2024-03-21] - Миграция хранения ID последних событий Allegro с Redis на PostgreSQL
### Изменено
- Создана новая модель `AllegroEventTracker` для хранения ID последних событий Allegro
- Добавлен репозиторий `AllegroEventTrackerRepository` для работы с моделью
- Модифицирована задача `process_allegro_order_events` для использования PostgreSQL вместо Redis
- Удалена зависимость от Redis для хранения ID последних событий

### Технические детали
- Новая таблица `allegro_event_trackers` содержит поля:
  - `id` (PK)
  - `token_id` (unique, indexed)
  - `last_event_id`
  - `created_at`
  - `updated_at`

## [2024-03-21] - Создание задачи для реализации редактирования товаров
### Добавлено
- Создана новая задача в tasktracker.md для реализации функциональности редактирования товаров
- Проанализирована текущая архитектура API для понимания требований к реализации

### Планируется
- Реализация API эндпоинта для обновления товаров (PUT/PATCH)
- Создание веб-интерфейса для редактирования товаров
- Добавление валидации данных при редактировании
- Интеграция с системой логирования операций
- Обновление Telegram бота для поддержки редактирования товаров

## [2024-03-21] - Создание моделей для редактирования товаров
### Добавлено
- Создан файл `app/schemas/product.py` с Pydantic схемами для работы с продуктами
- Добавлены схемы: `ProductBase`, `ProductCreate`, `ProductUpdate`, `ProductResponse`, `ProductEditForm`, `ProductUpdateRequest`, `ProductEditOperation`
- Добавлен новый тип операции `PRODUCT_EDIT` в `OperationType` enum
- Реализован метод `create_product_edit_operation` в `OperationsService` для логирования изменений
- Обновлен `app/schemas/__init__.py` для экспорта новых схем

### Технические детали
- Валидация EAN кодов с поддержкой множественных кодов через запятую
- Валидация формата SKU (буквы, цифры, дефисы, подчеркивания)
- Поддержка частичного обновления через `ProductUpdate` схему
- Интеграция с системой логирования операций для отслеживания изменений
- Подготовка для работы с изображениями в формате Base64

## [2024-03-21] - Реализация API эндпоинтов и веб-интерфейса для редактирования товаров
### Добавлено
- Реализован API эндпоинт `PUT /api/products/{sku}` для обновления товаров
- Создан веб-эндпоинт `GET /products/{sku}/edit` для отображения формы редактирования
- Создан HTML шаблон `edit_product.html` с формой редактирования товара
- Добавлена кнопка "Редактировать" в карточки товаров для администраторов
- Реализована JavaScript функция `editProduct()` для перехода к редактированию

### Технические детали
- Поддержка обновления названия, SKU, EAN и изображения товара
- Валидация уникальности SKU при изменении
- Обработка изображений с оптимизацией (WebP, 100x100px)
- Предпросмотр текущего и нового изображения
- Интеграция с системой логирования операций
- Проверка прав доступа (только администраторы)
- Автоматическое перенаправление на каталог после сохранения 