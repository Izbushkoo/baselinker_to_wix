## Задача: Локализация и улучшение UX мониторинга складских операций
- **Статус**: Завершена
- **Описание**: Полная локализация интерфейса мониторинга складских операций и улучшение пользовательского опыта
- **Шаги выполнения**:
  - [x] Создание системы локализации для логов операций - файл `app/utils/localization.py`
  - [x] Перевод всех действий операций на русский язык (stock_validation_failed → "Провал валидации остатков")
  - [x] Локализация сообщений логов с умными шаблонами и извлечением параметров
  - [x] Регистрация фильтров Jinja2 для локализации в роутерах stock_sync
  - [x] Добавление функции копирования SKU в интерфейсе деталей операций
  - [x] Реализация уведомлений о успешном копировании с плавной анимацией
  - [x] Кардинальное улучшение форматирования Telegram уведомлений о провале валидации
  - [x] Группировка ошибок по типам (общие ошибки vs проблемы с товарами)
  - [x] Отображение названий товаров, количества и кнопок копирования SKU в Telegram
  - [x] Обработка длинных названий товаров и ограничение количества показываемых ошибок
- **Зависимости**: Jinja2 фильтры, Telegram API, система уведомлений
- **Результат**: Полностью локализованный и удобный интерфейс мониторинга с улучшенными Telegram уведомлениями

## Задача: Исправление шаблонов и авторизации в мониторинге
- **Статус**: Завершена
- **Описание**: Исправление проблем с шаблонами и авторизацией в системе мониторинга складской синхронизации
- **Шаги выполнения**:
  - [x] Исправление шаблона `operation_details.html` - переход на наследование от `base.html`
  - [x] Полная переработка дизайна с использованием Tailwind CSS вместо пользовательских стилей
  - [x] Исправление проблемы с авторизацией - добавление передачи `user` и `current_user` в контекст шаблонов
  - [x] Устранение ошибки "UUID object is not subscriptable" в Jinja2 шаблонах
  - [x] Улучшение обработки UUID объектов с помощью фильтров `|string` и `|truncate`
  - [x] Обновление документации в changelog.md
- **Зависимости**: Шаблоны Jinja2, роутеры FastAPI, система авторизации
- **Результат**: Корректно работающие страницы мониторинга с правильной авторизацией и современным дизайном

## Задача: Упрощение интерфейса мониторинга синхронизации складов
- **Статус**: Завершена  
- **Описание**: Упрощение интерфейса мониторинга, добавление фильтров и улучшение UX
- **Шаги выполнения**:
  - [x] Упрощение таблицы операций: убраны лишние колонки (ID операции, склад, время создания, позиции)
  - [x] Добавление системы фильтрации по ID заказа, имени аккаунта и статусу
  - [x] Создание нового API endpoint `/api/stock-sync/operations` для получения всех операций
  - [x] Добавление поля `account_name` в модель `PendingStockOperation`
  - [x] Изменение логики попыток: убрано `max_retries`, оставлен только `retry_count`
  - [x] Обновление метода `increment_retry` для работы без максимального лимита
  - [x] Локализация статусов операций на русский язык
  - [x] Создание миграции для добавления поля `account_name` в БД
  - [x] Обновление документации проекта
- **Зависимости**: Модели данных, API роутеры, база данных, миграции
- **Результат**: Упрощенный и удобный интерфейс мониторинга с фильтрами

## Задача: Исправление критических ошибок в API endpoints мониторинга
- **Статус**: Завершена  
- **Описание**: Исправление критических ошибок аутентификации и базы данных при загрузке данных мониторинга
- **Шаги выполнения**:
  - [x] Анализ проблемы: API endpoints возвращали 401 Unauthorized
  - [x] Обнаружение несовместимости аутентификации: Bearer token vs cookie
  - [x] Исправление путей API с `/api/stock-sync/` на `/api/v1/stock-sync/`
  - [x] Изменение зависимостей аутентификации на `get_current_user_optional`
  - [x] Добавление правильной отправки cookie в JavaScript fetch
  - [x] Добавление автоматического перенаправления на страницу входа
  - [x] **КРИТИЧЕСКОЕ**: Исправление ошибки "'generator' object has no attribute 'exec'"
  - [x] Замена всех `get_session()` на `get_db()` в зависимостях
  - [x] **КРИТИЧЕСКОЕ**: Исправление ошибки "'PendingStockOperation' object has no attribute 'sku'"
  - [x] Удаление несуществующих полей `sku` и `quantity` из API ответа
  - [x] Добавление правильной обработки поля `line_items` для отображения позиций заказа
  - [x] Добавление колонки "Позиции" в таблицу мониторинга
  - [x] Обновление документации проекта
- **Зависимости**: API роутеры, система аутентификации, JavaScript код, база данных, модели данных
- **Критичность**: ВЫСОКАЯ - без исправления мониторинг не работал из-за ошибок аутентификации, БД и несуществующих полей

## Задача: Рефакторинг шаблона мониторинга синхронизации складов
- **Статус**: Завершена  
- **Описание**: Переработка шаблона stock_monitoring.html для использования базового шаблона и Tailwind CSS
- **Шаги выполнения**:
  - [x] Анализ базового шаблона base.html для понимания структуры
  - [x] Замена встроенных CSS стилей на Tailwind CSS классы
  - [x] Интеграция с базовым шаблоном через Jinja2 наследование
  - [x] Обновление JavaScript кода для работы с Tailwind классами
  - [x] Улучшение адаптивности с использованием Tailwind responsive классов
  - [x] Добавление современных hover-эффектов и анимаций
  - [x] Обновление документации проекта
- **Зависимости**: base.html, Tailwind CSS
- **Результат**: Единообразный дизайн с основным сайтом, улучшенная производительность

## Задача: Улучшение интерфейса мультипликатора цены
- **Статус**: Завершена  
- **Описание**: Улучшение пользовательского опыта работы с мультипликатором цены
- **Шаги выполнения**:
  - [x] Изменить минимальное значение с 0.01 на 0.1 для возможности ввода скидок
  - [x] Добавить динамическое обновление текста при изменении значения мультипликатора
  - [x] Создать JavaScript функцию `updateMultiplierText()` для реального времени обновления
  - [x] Добавить обработчик `oninput` к полю ввода мультипликатора
  - [x] Добавить ID к элементу текста для возможности его обновления
  - [x] Реализовать логику расчета наценки/скидки в процентах
  - [x] **КРИТИЧЕСКОЕ**: Исправить глобальную валидацию полей number, мешавшую вводу значений < 1
  - [x] Исключить поля мультипликатора из принудительной валидации минимального значения
- **Зависимости**: HTML шаблон product_manage.html
- **Улучшения UX**: Мгновенная обратная связь, возможность создания скидок, свободный ввод значений

## Задача: Исправление критической асимметрии синхронизации с Allegro
- **Статус**: Завершена  
- **Описание**: Исправление критической проблемы с отсутствием автоматической синхронизации остатков с Allegro при пополнении товара
- **Шаги выполнения**:
  - [x] Анализ проблемы: при списании синхронизация происходила, при пополнении - нет
  - [x] Обнаружение отсутствия строки `celery.send_task('sync_allegro_stock_single_product')` в функции `add_to_warehouse()`
  - [x] Добавление автоматического запуска задачи синхронизации при пополнении товара
  - [x] Проверка наличия необходимых импортов (`celery` уже был импортирован)
  - [x] Тестирование симметричности поведения: теперь и списание, и пополнение запускают синхронизацию
- **Зависимости**: Celery worker, настройки Allegro API
- **Критичность**: ВЫСОКАЯ - без этого исправления остатки на Allegro не обновлялись при пополнении

## Задача: Исправление критических ошибок в системе учета остатков
- **Статус**: Завершена  
- **Описание**: Исправление критической ошибки двойного подсчета остатков и проблем с синхронизацией данных
- **Шаги выполнения**:
  - [x] Исправить ошибку двойного подсчета в функции updateTotalStock() (селектор захватывал обе кнопки "Списать" и "Пополнить")
  - [x] Изменить логику подсчета: использовать только кнопки "Списать" для избежания дублирования
  - [x] Обеспечить синхронизацию data-current-quantity между всеми связанными элементами
  - [x] Обновить функцию removeFromStock() для корректного обновления кнопки "Пополнить"
  - [x] Обновить функцию addToStock() для корректного обновления кнопки "Списать"
- **Зависимости**: Интерфейс управления остатками на складах

## Задача: Расширенное автообновление оферт после действий пользователя
- **Статус**: Завершена  
- **Описание**: Добавление автообновления оферт после действий пользователя с увеличенной задержкой
- **Шаги выполнения**:
  - [x] Добавить автообновление оферт после обновления мультипликатора цены
  - [x] Добавить автообновление оферт после синхронизации цены для аккаунта
  - [x] Увеличить задержку автообновления с 1 до 3 секунд для корректного отображения изменений
  - [x] Исправить ошибку обработки NULL значений в данных цены от API Allegro
  - [x] Обновить обработку currentPrice и price для корректной работы с null значениями
- **Зависимости**: Интерфейс управления товаром, API оферт Allegro

## Задача: Обновление интерфейса блока оферт Allegro
- **Статус**: Завершена  
- **Описание**: Полное обновление интерфейса блока оферт с новым дизайном и автообновлением
- **Шаги выполнения**:
  - [x] Изменить дизайн заголовка оферты: "Оферта [ID]" слева, "Текущая цена: [price] [currency]" справа
  - [x] Убрать кнопку "Показать/Скрыть", сделать клик по контейнеру триггером разворота
  - [x] Добавить кнопку обновления оферт (иконка refresh)
  - [x] Реализовать автообновление оферт при изменениях цен, остатков и настроек синхронизации
  - [x] Обновить структуру данных API для корректного извлечения цены из saleInfo.currentPrice
  - [x] Добавить отображение основных данных: название, остатки (доступно/продано), статус
  - [x] Обновить детальную информацию при развороте: статистика, условия продажи, публикация
  - [x] Добавить события для автообновления в функции обновления цен, остатков и синхронизации
  - [x] Исправить ошибки с полем `expires_at` в модели AllegroToken
- **Зависимости**: Настроенные токены Allegro, активные оферты

## Задача: Исправления API endpoint оферт Allegro  
- **Статус**: Завершена  
- **Описание**: Исправление критических ошибок в API endpoint для получения оферт Allegro
- **Шаги выполнения**:
  - [x] Исправить ошибку `AttributeError: 'AllegroToken' object has no attribute 'expires_at'`
  - [x] Убрать зависимость от несуществующего поля `expires_at` в модели AllegroToken
  - [x] Исправить логику проверки токенов в функции `get_token` и `refresh_token`
  - [x] Добавить детальное логирование для диагностики проблем API
  - [x] Протестировать работоспособность endpoint'а `/api/products/{sku}/offers/{account_name}`
- **Зависимости**: Настроенные токены Allegro
- **Примечание**: Критическое исправление, которое устранило HTTP 500 ошибку при загрузке оферт

## Задача: Блок оферт Allegro в интерфейсе управления товарами
- **Статус**: Завершена  
- **Описание**: Реализация разворачивающегося блока оферт для каждого аккаунта Allegro в странице управления товаром с отображением основных и детальных данных об офертах
- **Шаги выполнения**:
  - [x] Создать API endpoint `/api/products/{sku}/offers/{account_name}` для получения оферт товара по аккаунту
  - [x] Добавить HTML блок оферт в шаблон `product_manage.html` с возможностью разворота
  - [x] Реализовать JavaScript функции для загрузки и отображения оферт
  - [x] Добавить отображение основной цены оферты до разворота блока  
  - [x] Реализовать детальное отображение информации об оферте при развороте (статистика, остатки, публикация, условия продажи)
  - [x] Добавить автоматическую загрузку сводки оферт при открытии страницы
  - [x] Реализовать кеширование загруженных оферт для оптимизации
  - [x] Добавить обработку ошибок с возможностью повторной попытки загрузки
  - [x] Исправить ошибки линтера JavaScript при смешивании с Jinja2 тегами
- **Зависимости**: API Allegro, токены аккаунтов, существующий механизм синхронизации
- **Примечание**: Блок отображает все найденные оферты для товара в каждом аккаунте Allegro. Показывает текущую цену, статус, статистику продаж, остатки и другую важную информацию. Реализован с адаптивным дизайном и интуитивно понятным интерфейсом.

## Задача: Полная переработка системы логирования
- **Статус**: Завершена
- **Описание**: Создание удобочитаемой системы логирования с фильтрацией технических логов для улучшения отладки бизнес-процессов
- **Шаги выполнения**:
  - [x] Анализ текущей системы логирования и выявление проблем с избыточным выводом
  - [x] Создание фильтра BusinessLogicFilter для исключения SQL запросов и технических деталей
  - [x] Реализация цветного форматтера ColoredFormatter для консоли
  - [x] Разделение логов по файлам: app.log (все логи), errors.log (только ошибки)
  - [x] Создание специальных логгеров для бизнес-логики (allegro.sync, wix.api, warehouse, etc.)
  - [x] Добавление функций для структурированного логирования: log_business_event, log_error_with_context
  - [x] Реализация переменных окружения для управления логированием: LOG_LEVEL, ENABLE_SQL_LOGS
  - [x] Обновление конфигурации Celery для уменьшения шума в логах
  - [x] Изменение уровня логирования SQLAlchemy в alembic.ini на ERROR
  - [x] Обновление импортов в main.py и celery_app.py для использования новой системы
  - [x] Добавление настроек логирования в example.env
  - [x] Создание документации по новой системе логирования (docs/logging_guide.md)
- **Зависимости**: Все модули приложения, Celery, SQLAlchemy
- **Результат**: Удобочитаемые логи с возможностью фильтрации технических деталей

## Задача: Механизм обновления цен в Allegro с исправлениями API
- **Статус**: Завершена
- **Описание**: Реализация полноценного механизма обновления цен на офферах Allegro с исправлением endpoint и структуры данных согласно документации Allegro API
- **Шаги выполнения**:
  - [x] Добавить метод update_offer_price в AllegroApiService с правильным endpoint PUT /sale/offers/{offerId}/change-price-commands/{commandId}
  - [x] Исправить структуру данных для обновления цены: используется input.buyNowPrice вместо sellingMode.price
  - [x] Добавить генерацию уникального UUID для commandId в каждом запросе
  - [x] Создать Celery задачу sync_allegro_price_single_product_account для синхронизации цены одного товара с одним аккаунтом
  - [x] Создать API endpoint /{sku}/sync-settings/{account_name}/sync-price для запуска синхронизации цены
  - [x] Интегрировать с exchange_service для конвертации цен из PLN в валюту оффера
  - [x] Добавить автоматическое получение валюты оффера из API Allegro
  - [x] Применить мультипликатор цены из настроек синхронизации
  - [x] Добавить проверку минимальной разности цен для избежания ненужных обновлений
  - [x] Обновить документацию (changelog.md, tasktracker.md)
  - [x] Исправить получение цены товара через prices_service
  - [x] Исправить несуществующие методы в ProductAllegroSyncService
  - [x] Добавить кнопку синхронизации цены в интерфейс
  - [x] Временно отключить конвертацию валют, использовать только PLN
  - [x] Обновить логику для обработки всех найденных офферов, а не только первого
- **Зависимости**: Существующая система синхронизации Allegro, exchange_service, модель ProductAllegroSyncSettings, prices_service
- **Примечание**: Система обновляет цены всех офферов товара на аккаунте. Временно отключена конвертация валют - используется только PLN. Поддерживает точность до 0.01 единицы валюты. Цены получаются через prices_service, а не из модели Product. Исправлены проблемы с endpoint и структурой данных для корректной работы с Allegro API. Добавлено детальное логирование для диагностики ошибок 400 Bad Request.

## Задача: Диагностика ошибки 400 Bad Request при обновлении цен в Allegro
- **Статус**: В процессе
- **Описание**: Устранение ошибки 400 Bad Request при вызове API изменения цены оффера
- **Шаги выполнения**:
  - [x] Добавить детальное логирование в sync_allegro_price_single_product_account
  - [x] Добавить форматирование цены f"{target_price:.2f}" для избежания научной нотации
  - [x] Добавить логирование endpoint, данных и заголовков в AllegroApiService
  - [ ] Проанализировать логи для выявления причины ошибки 400
  - [ ] Исправить проблему с форматом данных или endpoint
- **Зависимости**: Корректная документация Allegro API для endpoint /offers/{offerId}/change-price-commands/{commandId}
- **Примечание**: Endpoint и структура данных соответствуют документации, но API возвращает 400 Bad Request

## Задача: Автоматическая синхронизация при переключении настроек Allegro
- **Статус**: Завершена
- **Описание**: Добавление автоматического запуска синхронизации остатков и цен при переключении соответствующих настроек
- **Шаги выполнения**:
  - [x] Создать задачу `sync_allegro_stock_single_product_account` для синхронизации остатков конкретного товара с конкретным аккаунтом
  - [x] Создать задачу `sync_allegro_price_single_product_account` для синхронизации цен конкретного товара с конкретным аккаунтом
  - [x] Добавить автоматический запуск синхронизации в endpoint `toggle-stock` при включении настройки
  - [x] Добавить автоматический запуск синхронизации в endpoint `toggle-price` при включении настройки
  - [x] Добавить автоматический запуск синхронизации в endpoint `update-multiplier` при изменении мультипликатора
  - [x] Обновить документацию (changelog.md, tasktracker.md)
- **Зависимости**: Существующая система синхронизации Allegro
- **Примечание**: Задачи запускаются асинхронно и не блокируют HTTP-ответ, ошибки логируются без прерывания основного запроса

## Задача: Исправление кругового импорта в модулях Celery
- **Статус**: Завершена
- **Описание**: Устранение циклической зависимости между app/celery_app.py, app/services/warehouse/manager.py и app/services/allegro/sync_tasks.py
- **Шаги выполнения**:
  - [x] Проанализировать причину кругового импорта
  - [x] Создать план решения с отдельным модулем для общих объектов
  - [x] Обновить документацию (changelog.md, tasktracker.md)
  - [x] Создать app/celery_shared.py с общими объектами
  - [x] Обновить app/celery_app.py - убрать общие объекты, оставить только задачи
  - [x] Обновить app/services/allegro/sync_tasks.py - изменить импорт на celery_shared
  - [x] Код готов к тестированию (пользователь тестирует самостоятельно)
  - [x] Обновить документацию по завершении
- **Зависимости**: нет
- **Примечание**: Решение - создание app/celery_shared.py с общими объектами (celery, SessionLocal, get_allegro_token), что разорвало циклическую зависимость

## Задача: Исправление совместной работы фильтров по остаткам
- **Статус**: Завершена
- **Описание**: Исправление проблемы, когда фильтры по минимальному и максимальному количеству не работали одновременно
- **Шаги выполнения**:
  - [x] Диагностировать проблему с отдельными вызовами .having()
  - [x] Объединить условия фильтрации в один вызов .having() с логическим AND
  - [x] Выявить дополнительную проблему в JavaScript коде
  - [x] Исправить логику передачи параметров на фронтенде
  - [x] Упростить проверки в бэкенде
  - [x] Выявить проблему с пользовательским интерфейсом и логикой ввода
  - [x] Добавить автоматическую коррекцию некорректных значений фильтров
  - [x] Улучшить пользовательский интерфейс фильтров
  - [x] Добавить визуальные подсказки и математические символы
  - [x] Протестировать работу фильтров вместе
  - [x] Обновить changelog
  - [x] Обновить tasktracker
- **Зависимости**: нет
- **Примечание**: Основная проблема была в том, что пользователи путали поля фильтров и вводили значения наоборот. Добавлена автоматическая коррекция и улучшен UI.

## Задача: Расширенные фильтры каталога товаров
- **Статус**: Завершена
- **Описание**: Добавление новых фильтров для каталога товаров: фильтр "больше чем" для остатков и фильтр по бренду через выпадающий список
- **Шаги выполнения**:
  - [x] Создать эндпоинт для получения списка уникальных брендов
  - [x] Добавить параметр brand_filter в эндпоинты каталога
  - [x] Добавить параметр min_stock_filter в UI
  - [x] Обновить фронтенд: добавить выпадающий список брендов
  - [x] Обновить JavaScript для обработки новых фильтров
  - [x] Обновить документацию
- **Зависимости**: нет

## Задача: Интеграция с удаленной БД цен товаров
- **Статус**: Завершена
- **Описание**: Создание отдельного интерфейса для подключения к удаленной БД цен с возможностью получения и редактирования цен как для отдельных товаров, так и для всего каталога. Интеграция в существующие шаблоны с возможностью редактирования администраторами.
- **Шаги выполнения**:
  - [x] Добавить конфигурацию для подключения к удаленной БД цен
  - [x] Создать отдельный сервис для работы с БД цен (app/services/prices_service.py)
  - [x] Создать модели для работы с таблицей prices_data
  - [x] Реализовать полный CRUD интерфейс для работы с ценами
  - [x] Создать API роуты для получения/обновления цен
  - [x] Обновить шаблон карточки товара для отображения цены
  - [x] Обновить страницу управления товаром для отображения и редактирования цен
  - [x] Добавить JavaScript для редактирования цен администраторами
  - [x] Добавить модальные окна для редактирования цен
  - [x] Интегрировать получение цен в каталог товаров
  - [x] Добавить обработку ошибок и fallback при недоступности БД цен
  - [x] Обновить документацию проекта
- **Зависимости**: нет
- **Примечание**: Реализован полный интерфейс для работы с удаленной БД цен с поддержкой валют, массовых операций и статистики. Интеграция выполнена без breaking changes в существующую архитектуру.

## Задача: Автоматическая синхронизация остатков товаров с офферами Allegro
- **Статус**: В процессе
- **Описание**: Реализация системы автоматической синхронизации остатков товаров из локальной базы данных с офферами на всех аккаунтах Allegro при изменении остатков на складе
- **Шаги выполнения**:
  - [x] Реализовать пайплайн Celery задач для массовой синхронизации
  - [x] Добавить rate limiter для соблюдения лимитов API Allegro
  - [x] Реализовать систему уведомлений об ошибках в Telegram
  - [x] Добавить детальное логирование и мониторинг
  - [x] Добавить булевый флаг is_sync_enabled в модель товара и миграцию
  - [x] Реализовать задачу sync_allegro_stock_single_product для синхронизации одного товара по всем аккаунтам (**завершено**)
  - [x] Добавить API endpoint и кнопку в UI для запуска синхронизации одного товара (**завершено**)
  - [x] Исправить ошибку инициализации InventoryManager в Celery задачах (**завершено**)
  - [x] Исправить ошибку 405 Method Not Allowed в API Allegro (**завершено**)
  - [x] Создать таблицу блокировок productsynclock (**завершено**)
  - [ ] Обновить бизнес-логику синхронизации: сначала is_sync_enabled, затем логику с локами (**в процессе**)
  - [ ] Реализовать и интегрировать механизм блокировок (локов) для защиты от дублирующихся обновлений по SKU (**в процессе**)
  - [x] Добавить кнопку в UI карточки товара для ручного включения/отключения синхронизации (**завершено**)
  - [ ] Интегрировать задачу в планировщик Celery Beat (**запланировано**)
- **Зависимости**: нет

## Задача: Переработка системы синхронизации товаров с Allegro
- **Статус**: Завершена
- **Описание**: Переработка системы управления синхронизацией товаров с Allegro. Вместо общего флага is_sync_enabled для товара, реализация индивидуальных настроек синхронизации для каждого токена Allegro отдельно.
- **Цель**: Обеспечить более гибкое управление синхронизацией товаров с разными аккаунтами Allegro с возможностью настройки синхронизации остатков, цен и ценовых мультипликаторов для каждого аккаунта отдельно.
- **Шаги выполнения**:
  - [x] 1. Создать модель ProductAllegroSyncSettings для хранения настроек синхронизации товара с каждым токеном
  - [x] 2. Создать миграцию для новой модели
  - [x] 3. Создать новый роутер для страницы управления товаром /products/{sku}/manage
  - [x] 4. Создать HTML шаблон для страницы управления товаром с настройками синхронизации
  - [x] 5. Создать API эндпоинты для управления настройками синхронизации по токенам
  - [x] 6. Обновить компонент product_card.html - заменить тогл на кнопку управления
  - [ ] 7. Обновить логику синхронизации для учета индивидуальных настроек по токенам
  - [x] 8. Создать сервис для работы с настройками синхронизации товаров
- **Зависимости**: Существующие модели Product, AllegroToken, система синхронизации
- **Технические детали**:
  - Новая модель содержит: product_sku, allegro_account_name, stock_sync_enabled, price_sync_enabled, price_multiplier
  - Страница управления товаром показывает все данные товара + список токенов с настройками
  - Сохранена обратная совместимость с существующей системой
  - Архитектура готова для перехода на микросервисную систему
- **Прогресс**: Базовая система завершена. Остается только обновить существующую логику синхронизации для использования новых настроек.

## Задача: Изменить стартовое значение количества остатков на складах на 0
- **Статус**: В процессе
- **Описание**: Необходимо изменить стартовое значение input для количества в блоке управления остатками на складах с 1 на 0 на странице управления товаром.
- **Шаги выполнения**:
  - [x] Получено подтверждение на изменение
  - [ ] Внесены изменения в шаблон product_manage.html
  - [ ] Проведен code review и тестирование
  - [ ] Обновлен статус задачи
- **Зависимости**: Нет

## Задача: Исправление ссылок в уведомлениях о валидации заказов
- **Статус**: Завершена
- **Описание**: Исправить ссылки в Telegram уведомлениях о провале валидации заказов, чтобы они вели на правильную страницу деталей операции, а не на мониторинг по order_id.
- **Шаги выполнения**:
  - [x] Анализ проблемы - ссылки ведут не туда, куда нужно
  - [x] Проверка передачи operation_id в уведомления
  - [x] Исправление логики формирования ссылок в notify_order_validation_failure
  - [x] Улучшение форматирования ссылок в HTML формате для Telegram
  - [x] Обновление документации (changelog.md)
- **Зависимости**: Существующая система уведомлений, BASE_URL в конфигурации
- **Технические детали**:
  - operation_id уже передавался в метод, но не использовался для генерации ссылки
  - Добавлен fallback на мониторинг по order_id, если operation_id недоступен
  - Ссылки теперь ведут на `/stock-sync/monitor/operation/{operation_id}`
  - Использован HTML формат ссылок для лучшего отображения в Telegram
